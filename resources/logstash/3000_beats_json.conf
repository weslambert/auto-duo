#json parse for beats
filter {
  if "beat" in [tags] and [message] =~ "DUO_API_HOST" {
    mutate {
      add_tag => "duo_auth"
    }
    mutate {
      #gsub => [ "message", "\[|\]", "" ]
      #add_tag => "json"
    }
    json {
      source => "message"
      #skip_on_invalid_json => true
    }
    #mutate {
    #  remove_tag => "_jsonparsefailure"
    #}
    date {
      match => ["timestamp", "UNIX"]
    }
  }
} 
